#include<reg51.h>
#include<intrins.h>

typedef unsigned char u8;
typedef unsigned int u16;

sbit srclk = P3^6;
sbit clk = P3^5;
sbit ser = P3^4;

u8 code segmentNumber[] = {
/*--  ÎÄ×Ö:  °®  --*/
/*--  ËÎÌå12;  ´Ë×ÖÌåÏÂ¶ÔÓ¦µÄµãÕóÎª£º¿íx¸ß=16x16   --*/
0x80,0x64,0x2C,0x34,0x24,0x24,0xEC,0x32,0x22,0x22,0x32,0x2E,0x23,0xA2,0x60,0x00,
0x00,0x41,0x21,0x91,0x89,0x87,0x4D,0x55,0x25,0x25,0x55,0x4D,0x81,0x80,0x80,0x00
};			// the row
u8 code segmentNumber2[] = {
/*--  ÎÄ×Ö:  Äã  --*/
/*--  ËÎÌå12;  ´Ë×ÖÌåÏÂ¶ÔÓ¦µÄµãÕóÎª£º¿íx¸ß=16x16   --*/
0x00,0x80,0x60,0xF8,0x07,0x40,0x20,0x18,0x0F,0x08,0xC8,0x08,0x08,0x28,0x18,0x00,
0x01,0x00,0x00,0xFF,0x00,0x10,0x0C,0x03,0x40,0x80,0x7F,0x00,0x01,0x06,0x18,0x00,
};
u8 code bitNumber[] = {
0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80
};// the coloum

void delay(u16 i)
{
	while(i--);
}

void Write595(u8 dat1, u8 dat2, u8 dat3, u8 dat4)
{
	u8 i;
	for(i = 0;i < 8; i++)
	{
		ser = dat1>>7;
		dat1 = dat1<<1;

		srclk = 0;
		_nop_();
		_nop_();
		srclk = 1;
	}
	for(i = 0;i < 8; i++)
	{
		ser = dat2>>7;
		dat2 = dat2<<1;

		srclk = 0;
		_nop_();
		_nop_();
		srclk = 1;
	}
	for(i = 0;i < 8; i++)
	{
		ser = dat3>>7;
		dat3 = dat3<<1;

		srclk = 0;
		_nop_();
		_nop_();
		srclk = 1;
	}
	for(i = 0;i < 8; i++)
	{
		ser = dat4>>7;
		dat4 = dat4<<1;

		srclk = 0;
		_nop_();
		_nop_();
		srclk = 1;
	}
	clk = 0;
	_nop_();
	_nop_();
	clk = 1;
}

void main()
{
	u8 i = 0;
	u8 j = 0;
	u8 k = 0;
	  while(1)
	  {
	  					for(i = 0; i < 16; i++)
				{
					Write595(~bitNumber[i + 16], ~bitNumber[i], segmentNumber2[i + 16], segmentNumber2[i]);
				}
				delay(10);
	  }
}
